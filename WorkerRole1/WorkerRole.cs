using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using System.Net;
using System.Threading;
using System.Threading.Tasks;
using Microsoft.WindowsAzure;
using Microsoft.WindowsAzure.Diagnostics;
using Microsoft.WindowsAzure.ServiceRuntime;
using Microsoft.WindowsAzure.Storage;
using Microsoft.Owin.Hosting;

namespace WorkerRole1
{
    public class WorkerRole : RoleEntryPoint
    {
        private readonly CancellationTokenSource cancellationTokenSource = new CancellationTokenSource();
        private readonly ManualResetEvent runCompleteEvent = new ManualResetEvent(false);
        private IDisposable _app = null;



        public override void Run()
        {
            Trace.TraceInformation("WorkerRole1 is running");
            string html = " <html> <head> <meta charset='utf8'> <title>SuitArt Business Card</title> </head> <body> <div id='11asd'>Hello World</div>; <div id='MyRoster_EmailDiv' class='AciHidden' style='display: block;'> <table width='100%' cellpadding='0' cellspacing='0' border='0' id='backgroundTable' bgcolor='#ffffff' style='background:#ffffff; font-family:Helvetica, Arial, sans-serif;'> <tbody> <tr> <td style='text-align:center;'> <table width='600' cellpadding='0' cellspacing='0' border='0' align='center'> <tbody> <tr> <td style=' font-family:Helvetica, Arial, sans-serif; font-size:12px; color:#000000; text-align:left;'> <br> <p style='font-family:Helvetica, Arial, sans-serif; font-size:22px; margin:0; line-height:40px;'> <b>My Roster</b> </p> <table cellpadding='0' cellspacing='0' width='100%' height='2'> <tbody> <tr><td height='12' style='line-height:12px; font-size:12px'>&nbsp;</td></tr> <tr><td style='background:#dddddd; font-size:2px; line-height:2px; height:2px; border-top: 1px solid #dddddd;' height='2'>&nbsp;</td></tr> <tr><td height='12' style='line-height:12px; font-size:12px'>&nbsp;</td></tr> </tbody> </table> <table cellpadding='0' cellspacing='0' width='100%'> <tbody> <tr> <td style='font-family:Helvetica, Arial, sans-serif; font-size:16px; line-height:20px;'> <b field='RosterStartDate'>01-8-2015</b> to <b field='RosterEndDate'>31-8-2015</b> </td> <td style='font-family:Helvetica, Arial, sans-serif; font-size:10px;' align='right' valign='bottom'>All times are in local</td> </tr> </tbody> </table> <br> <table cellpadding='0' cellspacing='0' width='100%' height='2'> <tbody> <tr><td height='12' style='line-height:12px; font-size:12px'>&nbsp;</td></tr> <tr><td style='background:#dddddd; font-size:2px; line-height:2px; height:2px; border-bottom: 1px solid #dddddd;' height='2'>&nbsp;</td></tr> <tr><td height='12' style='line-height:12px; font-size:12px'>&nbsp;</td></tr> </tbody> </table> <br> <table cellpadding='0' cellspacing='0' width='100%'> <tbody> <tr style='font-family:Helvetica, Arial, sans-serif; font-size: 12px;'> <td width='15%' height='25'><b>Staff Number:</b></td> <td width='18%' field='StaffNumber'>417360</td> <td width='15%'><b>Name:</b></td> <td width='18%' field='FullName'>Iryna Lebediva</td> <td width='15%'><b>Grade:</b></td> <td width='18%' field='RosterGrade'>GR1</td> </tr> <tr style='font-family:Helvetica, Arial, sans-serif; font-size: 12px;'> <td width='15%' height='25'><b>Fleet:</b></td> <td width='18%' field='Fleet'>B777 Crew</td> <td width='15%'><b>Mailbox:</b></td> <td width='18%' field='Mailbox'>3396</td> <td width='15%'></td> <td width='18%'></td> </tr> </tbody> </table> <br> <!-- Start SVG chart --> <canvas style='display:none' id='canvas' width='577' height='73'></canvas> <div id='png-container'><img src='data:image/png;base64,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'></div> <!-- End SVG chart --> <br><br> <table id='rostTable' cellpadding='5' cellspacing='0' width='100%' border='1' bordercolor='#dee1e2' style='font-family:Helvetica, Arial, sans-serif; text-align:center; font-size: 11px; text-align: center; border-color: #dee1e2' class='roster'> <thead> <tr style=' background: #004B70; color:#ffffff; height:40px; font-size:16px; font-weight:400;'> <th colspan='3' height='40' style='font-size:16px; border:1px solid #ffffff;'>Duty</th> <th colspan='3' height='40' style='font-size:16px; border:1px solid #ffffff;'>Departure</th> <th colspan='3' height='40' style='font-size:16px; border:1px solid #ffffff;'>Arrival</th> <th height='40' style='border:1px solid #ffffff;'>&nbsp;</th> </tr> <tr style='background:#808080; color:#fff;'> <th>Date</th> <th>Type</th> <th>Rep. time</th> <th>Flight No.</th> <th>Station</th> <th>Time</th> <th>Station</th> <th>Time</th> <th>Dur.</th> <th>End</th> </tr> </thead> <tbody id='MyRosterEmailTbody'> <tr date='31/07/2015 02:40:00' datenum='31' finalflag='true'> <td field='DateDay' style='border-color: #dee1e2'>31 Fri</td> <td row='true' field='TripNo' class='trip span-3' rowspan='5' style='background-color: #b9ccee; position: relative; border-color: #dee1e2' tripno='7408' tripblockcount='1'> <b>7408</b> </td> <td field='RepTime' style='border-color: #dee1e2'>13:55</td> <td field='FlightNo' style='border-color: #dee1e2'>0408</td> <td field='DepStation' style='border-color: #dee1e2'>DXB</td> <td field='DepTime' style='border-color: #dee1e2'>02:40</td> <td field='ArrStation' style='border-color: #dee1e2'>KUL</td> <td field='ArrTime' style='border-color: #dee1e2'>13:50</td> <td field='Duration' style='border-color: #dee1e2'>11:10</td> <td style='border-color: #dee1e2'>&nbsp;</td> </tr> <tr date='01/08/2015 15:30:00' datenum='01' finalflag='true'> <td field='DateDay' style='border-color: #dee1e2'>01 Sat</td> <td field='RepTime' style='border-color: #dee1e2' rowspan='2'>13:55</td> <td field='FlightNo' style='border-color: #dee1e2' rowspan='2'>0408</td> <td field='DepStation' style='border-color: #dee1e2' rowspan='2'>KUL</td> <td field='DepTime' style='border-color: #dee1e2' rowspan='2'>15:30</td> <td field='ArrStation' style='border-color: #dee1e2' rowspan='2'>MEL</td> <td field='ArrTime' style='border-color: #dee1e2' rowspan='2'>01:00</td> <td field='Duration' style='border-color: #dee1e2' rowspan='2'>09:30</td> <td style='border-color: #dee1e2' rowspan='2'>&nbsp;</td> </tr> <tr date='02/08/2015 01:00:00' datenum='02' finalflag='true'> <td field='DateDay' style='border-color: #dee1e2'>02 Sun</td> </tr> <tr date='03/08/2015 02:40:00' datenum='03' finalflag='true'> <td field='DateDay' style='border-color: #dee1e2'>03 Mon</td> <td field='RepTime' style='border-color: #dee1e2'>13:55</td> <td field='FlightNo' style='border-color: #dee1e2'>0409</td> <td field='DepStation' style='border-color: #dee1e2'>MEL</td> <td field='DepTime' style='border-color: #dee1e2'>02:40</td> <td field='ArrStation' style='border-color: #dee1e2'>KUL</td> <td field='ArrTime' style='border-color: #dee1e2'>08:40</td> <td field='Duration' style='border-color: #dee1e2'>06:00</td> <td style='border-color: #dee1e2'>&nbsp;</td> </tr> <tr date='04/08/2015 10:10:00' datenum='04' finalflag='true'> <td field='DateDay' style='border-color: #dee1e2'>04 Tue</td> <td field='RepTime' style='border-color: #dee1e2'>13:55</td> <td field='FlightNo' style='border-color: #dee1e2'>0409</td> <td field='DepStation' style='border-color: #dee1e2'>KUL</td> <td field='DepTime' style='border-color: #dee1e2'>10:10</td> <td field='ArrStation' style='border-color: #dee1e2'>DXB</td> <td field='ArrTime' style='border-color: #dee1e2'>13:00</td> <td field='Duration' style='border-color: #dee1e2'>02:50</td> <td style='border-color: #dee1e2'>&nbsp;</td> </tr> <tr date='05/08/2015 00:01:00' datenum='05' finalflag='true'> <td field='DateDay' style='border-color: #dee1e2'>05 Wed</td> <td class='leave ' row='false' style='background: #e6c0bf; position: relative; border-color: #dee1e2'> <b>Leave</b> </td> <td colspan='8' class='blank' style='background: #F6F6F6; border-color: #dee1e2'>&nbsp;</td> </tr> <tr date='06/08/2015 00:01:00' datenum='06' finalflag='true'> <td field='DateDay' style='border-color: #dee1e2'>06 Thu</td> <td class='leave ' row='false' style='background: #e6c0bf; position: relative; border-color: #dee1e2'> <b>Leave</b> </td> <td colspan='8' class='blank' style='background: #F6F6F6; border-color: #dee1e2'>&nbsp;</td> </tr> <tr date='07/08/2015 00:01:00' datenum='07' finalflag='true'> <td field='DateDay' style='border-color: #dee1e2' rowspan='2'>07 Fri</td> <td row='true' class='training' rowspan='1' field='CourseName' style='background: #cdedc1; position: relative; border-color: #dee1e2' tripno='0' dutycode='XXR' codeblockcount='3'> <b>XXR</b> </td> <td field='RepTime' style='border-color: #dee1e2'>00:01</td> <td field='Details' style='border-color: #dee1e2' colspan='6'>DAY OFF (RSV CREW)</td> <td field='EndTime' style='border-color: #dee1e2'>23:59</td> </tr> <tr date='07/08/2015 08:20:00' datenum='07' finalflag='true'> <td row='true' field='TripNo' class='trip span-3' rowspan='4' style='background-color: #b9ccee; position: relative; border-color: #dee1e2' tripno='398' tripblockcount='2'> <b>398</b> </td> <td field='RepTime' style='border-color: #dee1e2'>13:55</td> <td field='FlightNo' style='border-color: #dee1e2'>0398</td> <td field='DepStation' style='border-color: #dee1e2'>DXB</td> <td field='DepTime' style='border-color: #dee1e2'>08:20</td> <td field='ArrStation' style='border-color: #dee1e2'>DPS</td> <td field='ArrTime' style='border-color: #dee1e2'>21:40</td> <td field='Duration' style='border-color: #dee1e2'>13:20</td> <td style='border-color: #dee1e2'>&nbsp;</td> </tr> <tr date='' datenum='08' finalflag='true'> <td field='DateDay' style='border-color: #dee1e2'>08 Sat</td> <td colspan='8'> Layover at DPS for 15: 23 hours </td></tr> <tr date='09/08/2015 23:40:00' datenum='09' finalflag='true'> <td field='DateDay' style='border-color: #dee1e2'>09 Sun</td> <td field='RepTime' style='border-color: #dee1e2' rowspan='2'>13:55</td> <td field='FlightNo' style='border-color: #dee1e2' rowspan='2'>0399</td> <td field='DepStation' style='border-color: #dee1e2' rowspan='2'>DPS</td> <td field='DepTime' style='border-color: #dee1e2' rowspan='2'>23:40</td> <td field='ArrStation' style='border-color: #dee1e2' rowspan='2'>DXB</td> <td field='ArrTime' style='border-color: #dee1e2' rowspan='2'>05:00</td> <td field='Duration' style='border-color: #dee1e2' rowspan='2'>05:20</td> <td style='border-color: #dee1e2' rowspan='2'>&nbsp;</td> </tr> <tr date='10/08/2015 05:00:00' datenum='10' finalflag='true'> <td field='DateDay' style='border-color: #dee1e2'>10 Mon</td> </tr> <tr date='11/08/2015 09:10:00' datenum='11' finalflag='true'> <td field='DateDay' style='border-color: #dee1e2'>11 Tue</td> <td row='true' field='TripNo' class='trip span-3' rowspan='2' style='background-color: #b9ccee; position: relative; border-color: #dee1e2' tripno='6097' tripblockcount='3'> <b>6097</b> </td> <td field='RepTime' style='border-color: #dee1e2'>13:55</td> <td field='FlightNo' style='border-color: #dee1e2'>0097</td> <td field='DepStation' style='border-color: #dee1e2'>DXB</td> <td field='DepTime' style='border-color: #dee1e2'>09:10</td> <td field='ArrStation' style='border-color: #dee1e2'>FCO</td> <td field='ArrTime' style='border-color: #dee1e2'>13:20</td> <td field='Duration' style='border-color: #dee1e2'>04:10</td> <td style='border-color: #dee1e2'>&nbsp;</td> </tr> <tr date='12/08/2015 15:25:00' datenum='12' finalflag='true'> <td field='DateDay' style='border-color: #dee1e2'>12 Wed</td> <td field='RepTime' style='border-color: #dee1e2'>13:55</td> <td field='FlightNo' style='border-color: #dee1e2'>0098</td> <td field='DepStation' style='border-color: #dee1e2'>FCO</td> <td field='DepTime' style='border-color: #dee1e2'>15:25</td> <td field='ArrStation' style='border-color: #dee1e2'>DXB</td> <td field='ArrTime' style='border-color: #dee1e2'>23:15</td> <td field='Duration' style='border-color: #dee1e2'>07:50</td> <td style='border-color: #dee1e2'>&nbsp;</td> </tr><tr date='13/8/2015 15:25:00' datenum='13' finalflag='true'> <td field='DateDay' style='border-color: #dee1e2'>13 Thu</td> <td field='DutyCode' style='border-color: #dee1e2'><b>Rest</b></td> <td colspan='8' class='blank' style='background: #F6F6F6; border-color: #dee1e2'>&nbsp;</td> </tr> <tr date='14/08/2015 00:01:00' datenum='14' finalflag='true'> <td field='DateDay' style='border-color: #dee1e2'>14 Fri</td> <td class='leave ' row='false' style='background: #e6c0bf; position: relative; border-color: #dee1e2'> <b>Leave</b> </td> <td colspan='8' class='blank' style='background: #F6F6F6; border-color: #dee1e2'>&nbsp;</td> </tr> <tr date='15/08/2015 00:01:00' datenum='15' finalflag='true'> <td field='DateDay' style='border-color: #dee1e2'>15 Sat</td> <td class='leave ' row='false' style='background: #e6c0bf; position: relative; border-color: #dee1e2'> <b>Leave</b> </td> <td colspan='8' class='blank' style='background: #F6F6F6; border-color: #dee1e2'>&nbsp;</td> </tr> <tr date='16/08/2015 15:10:00' datenum='16' finalflag='true'> <td field='DateDay' style='border-color: #dee1e2' rowspan='2'>16 Sun</td> <td row='true' field='TripNo' class='trip span-3' rowspan='3' style='background-color: #b9ccee; position: relative; border-color: #dee1e2' tripno='7953' tripblockcount='4'> <b>7953</b> </td> <td field='RepTime' style='border-color: #dee1e2'>13:55</td> <td field='FlightNo' style='border-color: #dee1e2'>0953</td> <td field='DepStation' style='border-color: #dee1e2'>DXB</td> <td field='DepTime' style='border-color: #dee1e2'>15:10</td> <td field='ArrStation' style='border-color: #dee1e2'>BEY</td> <td field='ArrTime' style='border-color: #dee1e2'>18:20</td> <td field='Duration' style='border-color: #dee1e2'>03:10</td> <td style='border-color: #dee1e2'>&nbsp;</td> </tr> <tr date='16/08/2015 19:45:00' datenum='16' finalflag='true'> <td field='RepTime' style='border-color: #dee1e2' rowspan='2'>13:55</td> <td field='FlightNo' style='border-color: #dee1e2' rowspan='2'>0954</td> <td field='DepStation' style='border-color: #dee1e2' rowspan='2'>BEY</td> <td field='DepTime' style='border-color: #dee1e2' rowspan='2'>19:45</td> <td field='ArrStation' style='border-color: #dee1e2' rowspan='2'>DXB</td> <td field='ArrTime' style='border-color: #dee1e2' rowspan='2'>00:55</td> <td field='Duration' style='border-color: #dee1e2' rowspan='2'>05:10</td> <td style='border-color: #dee1e2' rowspan='2'>&nbsp;</td> </tr> <tr date='17/08/2015 00:55:00' datenum='17' finalflag='true'> <td field='DateDay' style='border-color: #dee1e2'>17 Mon</td> </tr> <tr date='18/08/2015 14:45:00' datenum='18' finalflag='true'> <td field='DateDay' style='border-color: #dee1e2' rowspan='2'>18 Tue</td> <td row='true' field='TripNo' class='trip span-3' rowspan='3' style='background-color: #b9ccee; position: relative; border-color: #dee1e2' tripno='7546' tripblockcount='5'> <b>7546</b> </td> <td field='RepTime' style='border-color: #dee1e2'>13:55</td> <td field='FlightNo' style='border-color: #dee1e2'>0546</td> <td field='DepStation' style='border-color: #dee1e2'>DXB</td> <td field='DepTime' style='border-color: #dee1e2'>14:45</td> <td field='ArrStation' style='border-color: #dee1e2'>MAA</td> <td field='ArrTime' style='border-color: #dee1e2'>20:30</td> <td field='Duration' style='border-color: #dee1e2'>05:45</td> <td style='border-color: #dee1e2'>&nbsp;</td> </tr> <tr date='18/08/2015 21:45:00' datenum='18' finalflag='true'> <td field='RepTime' style='border-color: #dee1e2' rowspan='2'>13:55</td> <td field='FlightNo' style='border-color: #dee1e2' rowspan='2'>0547</td> <td field='DepStation' style='border-color: #dee1e2' rowspan='2'>MAA</td> <td field='DepTime' style='border-color: #dee1e2' rowspan='2'>21:45</td> <td field='ArrStation' style='border-color: #dee1e2' rowspan='2'>DXB</td> <td field='ArrTime' style='border-color: #dee1e2' rowspan='2'>00:30</td> <td field='Duration' style='border-color: #dee1e2' rowspan='2'>02:45</td> <td style='border-color: #dee1e2' rowspan='2'>&nbsp;</td> </tr> <tr date='19/08/2015 00:30:00' datenum='19' finalflag='true'> <td field='DateDay' style='border-color: #dee1e2'>19 Wed</td> </tr> <tr date='20/08/2015 11:00:00' datenum='20' finalflag='true'> <td field='DateDay' style='border-color: #dee1e2'>20 Thu</td> <td row='true' field='TripNo' class='trip span-3' rowspan='3' style='background-color: #b9ccee; position: relative; border-color: #dee1e2' tripno='7308' tripblockcount='6'> <b>7308</b> </td> <td field='RepTime' style='border-color: #dee1e2'>13:55</td> <td field='FlightNo' style='border-color: #dee1e2'>0308</td> <td field='DepStation' style='border-color: #dee1e2'>DXB</td> <td field='DepTime' style='border-color: #dee1e2'>11:00</td> <td field='ArrStation' style='border-color: #dee1e2'>PEK</td> <td field='ArrTime' style='border-color: #dee1e2'>22:20</td> <td field='Duration' style='border-color: #dee1e2'>11:20</td> <td style='border-color: #dee1e2'>&nbsp;</td> </tr> <tr date='' datenum='21' finalflag='true'> <td field='DateDay' style='border-color: #dee1e2'>21 Fri</td> <td colspan='8'> Layover at PEK for 31: 50 hours </td></tr> <tr date='22/08/2015 07:25:00' datenum='22' finalflag='true'> <td field='DateDay' style='border-color: #dee1e2'>22 Sat</td> <td field='RepTime' style='border-color: #dee1e2'>13:55</td> <td field='FlightNo' style='border-color: #dee1e2'>0309</td> <td field='DepStation' style='border-color: #dee1e2'>PEK</td> <td field='DepTime' style='border-color: #dee1e2'>07:25</td> <td field='ArrStation' style='border-color: #dee1e2'>DXB</td> <td field='ArrTime' style='border-color: #dee1e2'>11:35</td> <td field='Duration' style='border-color: #dee1e2'>04:10</td> <td style='border-color: #dee1e2'>&nbsp;</td> </tr> <tr date='23/08/2015 00:01:00' datenum='23' finalflag='true'> <td field='DateDay' style='border-color: #dee1e2'>23 Sun</td> <td class='leave ' row='false' style='background: #e6c0bf; position: relative; border-color: #dee1e2'> <b>Leave</b> </td> <td colspan='8' class='blank' style='background: #F6F6F6; border-color: #dee1e2'>&nbsp;</td> </tr> <tr date='24/08/2015 00:01:00' datenum='24' finalflag='true'> <td field='DateDay' style='border-color: #dee1e2'>24 Mon</td> <td row='true' class='training' rowspan='3' field='CourseName' style='background: #cdedc1; position: relative; border-color: #dee1e2' tripno='0' dutycode='CU' codeblockcount='6'> <b>CU</b> </td> <td field='RepTime' style='border-color: #dee1e2'>00:01</td> <td field='Details' style='border-color: #dee1e2' colspan='6'>Can-Use Reserve.</td> <td field='EndTime' style='border-color: #dee1e2'>23:59</td> </tr> <tr date='25/08/2015 00:01:00' datenum='25' finalflag='true'> <td field='DateDay' style='border-color: #dee1e2'>25 Tue</td> <td field='RepTime' style='border-color: #dee1e2'>00:01</td> <td field='Details' style='border-color: #dee1e2' colspan='6'>Can-Use Reserve.</td> <td field='EndTime' style='border-color: #dee1e2'>23:59</td> </tr> <tr date='26/08/2015 00:01:00' datenum='26' finalflag='true'> <td field='DateDay' style='border-color: #dee1e2'>26 Wed</td> <td field='RepTime' style='border-color: #dee1e2'>00:01</td> <td field='Details' style='border-color: #dee1e2' colspan='6'>Can-Use Reserve.</td> <td field='EndTime' style='border-color: #dee1e2'>23:59</td> </tr> <tr date='27/08/2015 00:01:00' datenum='27' finalflag='true'> <td field='DateDay' style='border-color: #dee1e2'>27 Thu</td> <td class='leave ' row='false' style='background: #e6c0bf; position: relative; border-color: #dee1e2'> <b>Leave</b> </td> <td colspan='8' class='blank' style='background: #F6F6F6; border-color: #dee1e2'>&nbsp;</td> </tr> <tr date='28/08/2015 00:01:00' datenum='28' finalflag='true'> <td field='DateDay' style='border-color: #dee1e2'>28 Fri</td> <td class='leave ' row='false' style='background: #e6c0bf; position: relative; border-color: #dee1e2'> <b>Leave</b> </td> <td colspan='8' class='blank' style='background: #F6F6F6; border-color: #dee1e2'>&nbsp;</td> </tr> <tr date='29/08/2015 00:01:00' datenum='29' finalflag='true'> <td field='DateDay' style='border-color: #dee1e2'>29 Sat</td> <td class='leave ' row='false' style='background: #e6c0bf; position: relative; border-color: #dee1e2'> <b>Leave</b> </td> <td colspan='8' class='blank' style='background: #F6F6F6; border-color: #dee1e2'>&nbsp;</td> </tr> <tr date='30/08/2015 00:01:00' datenum='30' finalflag='true'> <td field='DateDay' style='border-color: #dee1e2'>30 Sun</td> <td class='leave ' row='false' style='background: #e6c0bf; position: relative; border-color: #dee1e2'> <b>Leave</b> </td> <td colspan='8' class='blank' style='background: #F6F6F6; border-color: #dee1e2'>&nbsp;</td> </tr> <tr date='31/08/2015 00:01:00' datenum='31' finalflag='true'> <td field='DateDay' style='border-color: #dee1e2'>31 Mon</td> <td class='leave ' row='false' style='background: #e6c0bf; position: relative; border-color: #dee1e2'> <b>Leave</b> </td> <td colspan='8' class='blank' style='background: #F6F6F6; border-color: #dee1e2'>&nbsp;</td> </tr> </tbody> </table> <br> </td> </tr> </tbody> </table> </td> </tr></tbody></table> </div> </body> </html>";
            
            try
            {
                this.RunAsync(this.cancellationTokenSource.Token).Wait();
            }
            finally
            {
                this.runCompleteEvent.Set();
            }
        }

        public override bool OnStart()
        {
            // Set the maximum number of concurrent connections
            ServicePointManager.DefaultConnectionLimit = 12;

            // For information on handling configuration changes
            // see the MSDN topic at http://go.microsoft.com/fwlink/?LinkId=166357.

            bool result = base.OnStart();

            Trace.TraceInformation("WorkerRole1 has been started");

            var endpoint = RoleEnvironment.CurrentRoleInstance.InstanceEndpoints["Endpoint1"];
            string baseUri = String.Format("{0}://{1}",
                endpoint.Protocol, endpoint.IPEndpoint);

            Trace.TraceInformation(String.Format("Starting OWIN at {0}", baseUri),
                "Information");

            _app = WebApp.Start<Startup>(new StartOptions(url: baseUri));


            return result;
        }

        public override void OnStop()
        {
            Trace.TraceInformation("WorkerRole1 is stopping");

            this.cancellationTokenSource.Cancel();
            this.runCompleteEvent.WaitOne();
            if (_app != null)
            {
                _app.Dispose();
            }

            base.OnStop();

            Trace.TraceInformation("WorkerRole1 has stopped");
        }

        private async Task RunAsync(CancellationToken cancellationToken)
        {
            // TODO: Replace the following with your own logic.
            while (!cancellationToken.IsCancellationRequested)
            {
                Trace.TraceInformation("Working");
                await Task.Delay(1000);
            }
        }


    }
}
